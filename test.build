<?xml version="1.0" encoding="iso-8859-1"?>

<project name="NAnt" default="build" basedir=".">
	<property name="debug" value="false"/>
	<property name="project.name" value="nant"/>
	<property name="project.version" value="0.6.0"/> 	<!-- TODO: get this from AssemblyInfo.cs using a regular expression some how -->
	<property name="dir.dist" value="dist"/>
	<property name="dir.build" value="build"/>
	<property name="zipfile.bin" value="${project.name}-src-${project.version}.zip" />

	<echo message="Building ${project.name}-${project.version}"/>

	<target name="clean">
		<delete dir="build" recursive="true"/>
		<delete dir="dist" recursive="true"/>
	</target>

	<target name="build">
		<mkdir dir="build"/>
		<csc target="exe" output="build\NAnt.exe" debug="${debug}">
			<sources basedir="src\NAnt">
				<includes name="**/*.cs"/>
			</sources>
			<references/>
		</csc>
	</target>

	<target name="test" depends="build">
		<nant basedir="examples"/>
	</target>


	<target name="dist" depends="build">
		<mkdir dir="${dir.dist}\bin"/>
		<copy file="${dir.build}\NAnt.exe" todir="${dir.dist}\bin"/>

		<mkdir dir="${dir.dist}\doc"/>
		<copy todir="${dir.dist}\doc">
			<fileset basedir="doc">
				<includes name="*.html"/>
				<includes name="*.gif"/>
				<includes name="*.css"/>
			</fileset>
		</copy>

		<copy todir="${dir.dist}">
			<fileset>
				<includes name="src\**"/>
			</fileset>
		</copy>
<!--
		<call target="clean-tests"/>
-->
		<copy todir="${dir.dist}\src">
			<fileset basedir="src">
				<includes name="**"/>
			</fileset>
		</copy>

		<nant buildfile="examples\examples.build" target="clean" basedir="examples"/>
		<copy todir="${dir.dist}\examples">
			<fileset basedir="examples">
				<includes name="**"/>
			</fileset>
		</copy>

		<copy todir="${dir.dist}">
			<fileset dir=".">
				<includes name="NAnt.build"/>
				<includes name="NAnt.key"/>
				<includes name="README.txt"/>
				<includes name="COPYING.txt"/>
			</fileset>
		</copy>
-->
	</target>
<!--
	<target name="zip" depends="dist">
		<zip zipfile="${zipfile.bin}">
			<fileset dir="${dir.dist}">
				<excludes name="**/*.zip"/>
			</fileset>
		</zip>
	</target>
-->
</project>
